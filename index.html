<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STEINStacks Game</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      background: #151927;
      min-height: 100vh;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .game-card {
      background: linear-gradient(135deg, #22263d 85%, #2c314a 100%);
      border-radius: 2rem;
      box-shadow: 0 0 40px 0 #0ff7ff44, 0 0 0 3px #222a;
      padding: 2rem 2rem 1.5rem 2rem;
      max-width: 350px;
      width: 100%;
      border: 2px solid #2fd6ff55;
      position: relative;
      overflow: hidden;
    }
    .bet-info {
      color: #00fff7;
      font-size: 2rem;
      font-weight: bold;
      letter-spacing: 2px;
      margin-bottom: .5rem;
      text-align: left;
      text-shadow: 0 0 10px #00fff7, 0 0 40px #00fff744;
    }
    .up-btn, .down-btn {
      width: 110px;
      height: 56px;
      font-size: 1.6rem;
      font-weight: bold;
      margin-bottom: 1rem;
      border-radius: 1.2rem;
      border: none;
      box-shadow: 0 0 20px 0 #00ff9466;
      transition: 0.15s;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      outline: none;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .up-btn {
      background: #042e20;
      color: #0fffa6;
      box-shadow: 0 0 20px #0fffa6, 0 0 40px #0fffa644;
      border: 2px solid #0fffa6;
      margin-bottom: 1rem;
    }
    .up-btn:hover {
      background: #0fffa6;
      color: #042e20;
      box-shadow: 0 0 30px #0fffa6, 0 0 60px #0fffa688;
    }
    .down-btn {
      background: #2c1702;
      color: #ff8900;
      box-shadow: 0 0 20px #ff8900, 0 0 40px #ff890044;
      border: 2px solid #ff8900;
    }
    .down-btn:hover {
      background: #ff8900;
      color: #2c1702;
      box-shadow: 0 0 30px #ff8900, 0 0 60px #ff890088;
    }
    .balance-card {
      background: #191e30cc;
      border-radius: 1rem;
      padding: .7rem 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 1.2rem;
      font-size: 1.6rem;
      font-weight: bold;
      color: #ffe082;
      box-shadow: 0 0 14px #ffe08233;
    }
    .balance-card .btc {
      color: #ffae00;
      font-size: 1.7rem;
      margin-right: 0.4rem;
      text-shadow: 0 0 12px #ffae00aa;
    }
    .instruction {
      background: #232941;
      border-radius: 1rem;
      margin-top: 1.5rem;
      margin-bottom: 0.4rem;
      padding: 0.7rem 1rem;
      color: #fff;
      font-size: 1.12rem;
      text-align: center;
      font-weight: 500;
      box-shadow: 0 0 8px #0ff7ff22;
    }
    .character-img {
      display: block;
      margin: 0 auto;
      margin-top: 1.2rem;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      /* Use your own character image here */
      background: url('https://i.ibb.co/4P7jP8j/einstein-icon.png') center center/cover no-repeat, #2a2d40;
      box-shadow: 0 0 40px #fff4, 0 0 60px #0ff7ff33;
    }
    .chart-container {
      margin-bottom: 1.2rem;
      margin-top: 0.4rem;
      background: transparent;
      border-radius: 1.2rem;
      overflow: hidden;
      height: 120px;
    }
    #chart {
      background: transparent !important;
      max-height: 120px;
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="game-card">
    <div class="bet-info">/BET <span id="bet-amount">+300</span></div>
    <div class="chart-container">
      <canvas id="chart"></canvas>
    </div>
    <div style="display: flex; flex-direction: column; align-items: flex-start; gap: 0.5rem; margin-bottom: 0.5rem;">
      <button class="up-btn" onclick="makeBet('up')"><span style="font-size: 2rem; margin-right: 0.5rem;">⬆️</span>UP</button>
      <button class="down-btn" onclick="makeBet('down')"><span style="font-size: 2rem; margin-right: 0.5rem;">⬇️</span>DOWN</button>
    </div>
    <div class="character-img"></div>
    <div class="instruction">Make your bet: will the price go up or down?</div>
    <div class="balance-card">
      <span class="btc">₿</span> <span id="balance">$1200</span>
    </div>
  </div>
  <script>
    // Chart.js candlestick-style chart
    const ctx = document.getElementById('chart').getContext('2d');
    let chart;

    async function fetchPrices() {
      try {
        const response = await fetch(
          'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1m&limit=18')
        );
        if (!response.ok) throw new Error('Network response was not ok');
        const data = await response.json();
        return data.map(d => ({
          time: d[0],
          open: +d[1],
          high: +d[2],
          low: +d[3],
          close: +d[4]
        }));
      } catch (error) {
        // Fallback: generate random data
        let now = Date.now();
        let arr = [];
        let lastClose = 30000;
        for (let i = 0; i < 18; i++) {
          let open = lastClose;
          let change = Math.random() * 200 - 100;
          let close = open + change;
          let high = Math.max(open, close) + Math.random() * 50;
          let low = Math.min(open, close) - Math.random() * 50;
          arr.push({ time: now - (17 - i) * 60000, open, high, low, close });
          lastClose = close;
        }
        return arr;
      }
    }

    // Draw pseudo-candlesticks on Chart.js line chart
    function updateChart(data) {
      if (!data.length) return;
      const labels = data.map(d => '');
      const prices = data.map(d => d.close);

      // Colorize "candlesticks"
      const candlestickColors = data.map(d => d.close >= d.open ? '#0fffa6' : '#ff8900');

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [
            {
              label: 'Candlesticks',
              data: data.map(d => d.close - d.open),
              backgroundColor: candlestickColors,
              borderSkipped: false,
              borderWidth: 2,
              barPercentage: 1,
              categoryPercentage: 1,
              base: data.map(d => d.open),
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            x: { display: false, stacked: true },
            y: {
              display: false,
              beginAtZero: false,
              grid: { display: false }
            }
          }
        }
      });
    }

    // UI logic
    let balance = 1200;
    let betAmount = 300;

    function updateBalance() {
      document.getElementById('balance').textContent = `$${balance}`;
    }
    function updateBet() {
      document.getElementById('bet-amount').textContent = `+${betAmount}`;
    }

    function makeBet(direction) {
      // Random win/lose logic for demo
      const win = Math.random() > 0.5;
      if (win) {
        balance += betAmount;
      } else {
        balance -= betAmount;
      }
      updateBalance();
      // Optionally: animate win/loss, etc.
    }

    async function refreshChart() {
      const data = await fetchPrices();
      updateChart(data);
    }

    refreshChart();
    updateBalance();
    updateBet();
    setInterval(refreshChart, 60000);
  </script>
</body>
</html>